import pandas as pd

def test_fetch_data_postcode():
    # Test that the data is fetched correct
    postcode_manager = PostcodeDatasetManager()
    postcode_paths = postcode_manager.fetch_data()

    assert len(postcode_paths) == 1
    assert all(
        [postcode_paths[i].name == "open_postcode_geo.csv" for i in range(1)]
    )

    postcode_data = pd.read_csv(postcode_paths[0])
    assert postcode_data.shape == (2638851, 43)
    for col in [
        "postcode",
        "status",
        "terminated",
        "usertype",
        "large",
        "easting",
        "northing",
        "positional_quality_indicator",
        "country",
        "Wales",
        "Scotland",
        "Northern",
        "Channel",
        "Isle",
        "latitude",
        "longitude",
        "postcode_no_space",
        "postcode_fixed_width_seven",
        "postcode_fixed_width_eight",
        "postcode_area",
        "postcode_district",
        "postcode_sector",
        "outcode",
        "incode",
    ]:
        assert col in postcode_data.columns